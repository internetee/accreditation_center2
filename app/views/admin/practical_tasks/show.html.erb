<% content_for(:title) { "EIS | #{@practical_task.title}" } %>
<% content_for :hero do %>
    <div class="layout--hero">
        <h1><%= @practical_task.title %></h1>
        <%= back_link(text: t('.back_to_practical_tasks'), path: admin_test_practical_tasks_path(@test)) %>
    </div>
<% end %>

<div class="page page--admin-practical-task-show">
  <div class="page--header">
    <div class="wrapper">
      <div class="row center-xs">
        <div class="col-xs-auto">
          <%= link_to t(:edit), edit_admin_test_practical_task_path(@test, @practical_task), class: 'button button--secondary' %>
        </div>
        <div class="col-xs-auto">
          <% if @practical_task.active? %>
            <%= link_to t(:deactivate), deactivate_admin_test_practical_task_path(@test, @practical_task),  
                        class: 'button button--error',
                        data: { turbo: true, turbo_method: :patch, turbo_confirm: t('.confirm_deactivate') } %>
          <% else %>
            <%= link_to t(:activate), activate_admin_test_practical_task_path(@test, @practical_task),
                        data: { turbo: true, turbo_method: :patch, turbo_confirm: t('.confirm_activate') },
                        class: 'button button--success' %>
          <% end %>
        </div>
        <div class="col-xs-auto">
          <%= link_to t('.view_results'), admin_test_practical_task_practical_task_results_path(@test, @practical_task), class: 'button button--secondary' %>
        </div>
        <div class="col-xs-auto">
          <%= link_to t(:delete), admin_test_practical_task_path(@test, @practical_task),
                      class: 'button button--danger',
                      data: { turbo: true, turbo_method: :delete, turbo_confirm: t('.confirm_delete') } %>
        </div>
      </div>
    </div>
  </div>
  
  <div class="wrapper">
    <div class="row">
      <div class="col-md-6 col-xs-12">
        <div class="paper">
          <div class="paper--header">
            <h3><%= t('.task_information') %></h3>
            <div class="task-status">
              <% if @practical_task.active? %>
                <span class="label label-success"><%= t('.active') %></span>
              <% else %>
                <span class="label label-default"><%= t('.inactive') %></span>
              <% end %>
            </div>
          </div>
          
          <div class="paper--content">
            <div class="info-section">
              <h4><%= t('.descriptions') %></h4>
              <div class="description-pair">
                <div class="description-item">
                  <strong><%= t('.estonian') %>:</strong>
                  <p><%= @practical_task.body_et %></p>
                </div>
                <div class="description-item">
                  <strong><%= t('.english') %>:</strong>
                  <p><%= @practical_task.body_en %></p>
                </div>
              </div>
            </div>
            
            <div class="info-section">
              <h4><%= t('.task_configuration') %></h4>
              <div class="config-grid">
                <div class="config-item">
                  <span class="config-label"><%= t('.klass_name') %>:</span>
                  <span class="config-value"><%= @practical_task.klass_name || t('.not_configured') %></span>
                </div>
                <div class="config-item">
                  <span class="config-label"><%= t('.display_order') %>:</span>
                  <span class="config-value"><%= @practical_task.display_order %></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="col-md-6 col-xs-12">
        <div class="paper">
          <div class="paper--header">
            <h3><%= t('.validator_configuration') %></h3>
          </div>
          
          <div class="paper--content">
            <% if @practical_task.validator.present? %>
              <div class="validator-config">
                <h4><%= t('.validator_details') %></h4>
                <pre><%= JSON.pretty_generate(@practical_task.validator) %></pre>
              </div>
              
              <% if @practical_task.input_fields.any? %>
                <div class="input-fields">
                  <h4><%= t('.input_fields') %></h4>
                  <ul>
                    <% @practical_task.input_fields.each do |field| %>
                      <li><%= field %></li>
                    <% end %>
                  </ul>
                </div>
              <% end %>
              
              <% if @practical_task.deps.any? %>
                <div class="dependencies">
                  <h4><%= t('.dependencies') %></h4>
                  <ul>
                    <% @practical_task.deps.each do |dep_id| %>
                      <li><%= dep_id %></li>
                    <% end %>
                  </ul>
                </div>
              <% end %>
            <% else %>
              <div class="empty-state">
                <p><%= t('.no_validator_configured') %></p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
